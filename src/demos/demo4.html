

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example 4 &mdash; felapps 1.5.13 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="felapps 1.5.13 documentation" href="../../index.html"/>
        <link rel="up" title="Examples and Demonstrations" href="../demo.html"/>
        <link rel="next" title="Example 5" href="demo5.html"/>
        <link rel="prev" title="Example 3" href="demo3.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> felapps
          

          
          </a>

          
            
            
              <div class="version">
                1.5.13
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy.html">Deployment</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../demo.html">Examples and Demonstrations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="demo1.html">Example 1: &#8216;imageviewer&#8217; &#8212; Fetch image figure and data</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo2.html">Example 2: &#8216;dataworkshop&#8217; &#8212; Post-processing about the figure data</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo3.html">Example 3: &#8216;cornalyzer&#8217; &#8212; Parameters correlation analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Example 4: &#8216;felformula&#8217; &#8212; FEL physics calculator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-guide">Usage Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fel-calculation">FEL Calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters-scan">Parameters Scan</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="demo5.html">Example 5: &#8216;latticeviewer&#8217; &#8212; Online-model GUI app</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo6.html">Example 6: &#8216;wxmpv&#8217; &#8212; General matplot viewer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">felapps</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../demo.html">Examples and Demonstrations</a> &raquo;</li>
      
    <li>Example 4</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example-4">
<h1>Example 4<a class="headerlink" href="#example-4" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">felformula</span></code> &#8211; Basic FEL physics calculator app.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Help users/operators or other non-FEL physics specialists to understand
the FEL facility performance under certain machine configurations should
be significant, this app is created for such mission that not only
providing the staright-forward FEL calculation results, but also showing
the clues for the FEL specialists to tunning the machine.</p>
<p>The main features of <code class="docutils literal"><span class="pre">felformula</span></code> are:</p>
<blockquote>
<div><ul>
<li><p class="first">FEL parameters calculations based on analytical formulae;</p>
</li>
<li><p class="first">Parameters scan studies, valid parameters:</p>
<blockquote>
<div><table class="hlist"><tr><td><ul class="simple">
<li>Beam energy, <span class="math">\(E_b\)</span>, unit: <em>MeV</em></li>
<li>Energy spread, <span class="math">\(\sigma_\gamma\)</span></li>
</ul>
</td><td><ul class="simple">
<li>Transverse emittance, <span class="math">\(\epsilon_n\)</span>, unit: <em>m</em></li>
<li>Peak current, <span class="math">\(I_p\)</span>, unit: <em>A</em></li>
</ul>
</td><td><ul class="simple">
<li>Undulator period, <span class="math">\(\lambda_u\)</span>, unit: <em>m</em></li>
<li>FEL wavelength, <span class="math">\(\lambda_s\)</span>, unit: <em>m</em></li>
</ul>
</td><td><ul class="simple">
<li>Average beta function, <span class="math">\(\beta\)</span>, unit: <em>m</em></li>
<li>Bunch charge, <span class="math">\(Q\)</span>, unit: <em>C</em></li>
</ul>
</td></tr></table>
</div></blockquote>
</li>
<li><p class="first">Interactive scan results figure plot;</p>
</li>
<li><p class="first">Data saving/exporting and loading/importing.</p>
</li>
</ul>
</div></blockquote>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Comprehensive FEL physics studies could be extended to
<code class="docutils literal"><span class="pre">felformula</span></code>, e.g. integrate numerical simulations into <code class="docutils literal"><span class="pre">Advanced</span></code>
menu (should be created first into the menubar), into which modules
could be built to implement various FEL
simulation modes, like SASE, HGHG, EEHG, PEHG, and mixtures of them,
etc., as well as the algorithms like Twiss-matching,
multi-parameters optimization, post-processing for data analyais, etc.
Note that every single module should be built with clean and clear
APIs, so as to communicate with other modules or apps.</p>
</div>
</div>
<div class="section" id="usage-guide">
<h2>Usage Guide<a class="headerlink" href="#usage-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fel-calculation">
<h3>FEL Calculation<a class="headerlink" href="#fel-calculation" title="Permalink to this headline">¶</a></h3>
<p>Open <code class="docutils literal"><span class="pre">felformula</span></code> as the previous examples demonstrated. Fill the
<code class="docutils literal"><span class="pre">Beam</span> <span class="pre">Parameters</span></code> panel to setup the main parameters of an FEL
facility, e.g. Dalian Coherent Light Source, the physics meaning of
every input parameter should be explained by the name itself.
Push <code class="docutils literal"><span class="pre">Calculate</span></code> button in the <code class="docutils literal"><span class="pre">Operations</span> <span class="pre">&gt;</span> <span class="pre">Command</span></code> panel to
calculate/update the output parameters that listed in <code class="docutils literal"><span class="pre">FEL</span> <span class="pre">Calculations</span></code>
panel, where all the available parameters are grouped into
<code class="docutils literal"><span class="pre">Undulator</span> <span class="pre">and</span> <span class="pre">E-beam</span></code> and <code class="docutils literal"><span class="pre">FEL</span> <span class="pre">radiation</span></code> categories, note that
these calculated resutls are only for reference.</p>
<a class="reference internal image-reference" href="../../_images/felformula_01.png"><img alt="../../_images/felformula_01.png" src="../../_images/felformula_01.png" style="width: 500px;" /></a>
<p>All the data could be exported by <code class="docutils literal"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Export</span> <span class="pre">(SHIFT+CTRL+E)</span></code>,
additional meta information could be appended into saved file, see the
following image.</p>
<a class="reference internal image-reference" href="../../_images/felformula_02.png"><img alt="../../_images/felformula_02.png" src="../../_images/felformula_02.png" style="width: 500px;" /></a>
<p>While the exported data file could also be imported by
<code class="docutils literal"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Import</span> <span class="pre">(SHIFT+CTRL+I)</span></code>, here is the exported file example,</p>
<div class="highlight-rest"><div class="highlight"><pre><span></span>[00-info]
author = Tong Zhang
created_time = 2016-09-01 07:20:38 CST
note = note = FEL user facility based on HGHG principle, generating FEL radiations from 50-150nm, pulse energy of &gt;100 uJ.

[01-facility]
affiliation = DICP
country = China
name = Dalian Coherent Light Source

[02-electron_beam]
average_beta_function(m) = 10
bunch_charge(C) = 0.5e-9
bunch_length_t(fs) = 664.9
bunch_length_z(um) = 199.5
bunch_shape = gaussian
central_energy(MeV) = 300
energy_spread = 0.0001
normalized_emittance(m) = 2e-6
peak_current(A) = 300
transverse_beam_size(m) = 184.6

[03-undulator]
K = 0.870
au = 0.615
gap(mm) = 11.861
peak_field(T) = 0.373
period_length(m) = 0.025
total_length(m) = 12
type = planar

[04-FEL_radiation]
FEL_parameter_1D = 1.180e-03
FEL_parameter_3D = 1.018e-03
bandwidth(%) = 0.33
gainlength_1D(m) = 0.973
gainlength_3D(m) = 1.128
output_power(W) = 4.485e+03
photon_energy(eV) = 25
photon_per_pulse = 1.88e+09
pulse_energy(uJ) = 0.0075
saturation_length_SASE(m) = 23.57
saturation_power_MXie(W) = 1.265e+08
saturation_power_SASE(W) = 1.278e+08
shotnoise_power_SASE(W) = 0.97
wavelength(m) = 50e-9

</pre></div>
</div>
</div>
<div class="section" id="parameters-scan">
<h3>Parameters Scan<a class="headerlink" href="#parameters-scan" title="Permalink to this headline">¶</a></h3>
<p>Parameters scan feature is supported by checking the <code class="docutils literal"><span class="pre">Enable</span> <span class="pre">Scan</span></code> box,
and selecting the parameter to be altered, e.g. average beta function.</p>
<a class="reference internal image-reference" href="../../_images/felformula_03.png"><img alt="../../_images/felformula_03.png" src="../../_images/felformula_03.png" style="width: 500px;" /></a>
<p>Click <code class="docutils literal"><span class="pre">Calculate</span></code> first, then <code class="docutils literal"><span class="pre">Show</span> <span class="pre">Plot</span></code> to open the figure plot
window, where the data for Y-axis could be seleted from the following table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="37%" />
<col width="44%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Choice</th>
<th class="head">Symbol</th>
<th class="head">Literal explanations</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>01-au</td>
<td><span class="math">\(a_u\)</span></td>
<td>Normalized undulator parameter</td>
</tr>
<tr class="row-odd"><td>02-K</td>
<td><span class="math">\(K\)</span></td>
<td>Undulator parameter</td>
</tr>
<tr class="row-even"><td>03-Bu</td>
<td><span class="math">\(B_u\ \mathrm{[T]}\)</span></td>
<td>Undulator magnetic peak field [T]</td>
</tr>
<tr class="row-odd"><td>04-gap</td>
<td><span class="math">\(\mathrm{Gap\ [mm]}\)</span></td>
<td>Permanent undulator gap [mm]</td>
</tr>
<tr class="row-even"><td>05-rho1D</td>
<td><span class="math">\(\rho^{\mathrm{1D}}\)</span></td>
<td>FEL parameter or Pierce parameter (1D)</td>
</tr>
<tr class="row-odd"><td>06-rho3D</td>
<td><span class="math">\(\rho^{\mathrm{3D}}\)</span></td>
<td>FEL parameter or Pierce parameter (3D)</td>
</tr>
<tr class="row-even"><td>07-Lg1D</td>
<td><span class="math">\(L_g^{\mathrm{1D}}\ \mathrm{[m]}\)</span></td>
<td>FEL power gain length (1D) [m]</td>
</tr>
<tr class="row-odd"><td>08-Lg3D</td>
<td><span class="math">\(L_g^{\mathrm{3D}}\ \mathrm{[m]}\)</span></td>
<td>FEL power gain length (3D) [m]</td>
</tr>
<tr class="row-even"><td>09-Psat</td>
<td><span class="math">\(P_{\mathrm{sat}}\ \mathrm{[W]}\)</span></td>
<td>FEL saturation power (M.Xie formulae) [W]</td>
</tr>
<tr class="row-odd"><td>10-Pshot</td>
<td><span class="math">\(P_{\mathrm{shot}}\ \mathrm{[W]}\)</span></td>
<td>FEL initial shotnoise power [W]</td>
</tr>
<tr class="row-even"><td>11-Pss</td>
<td><span class="math">\(P_{\mathrm{ss}}\ \mathrm{[W]}\)</span></td>
<td>FEL saturation power (SASE) [W]</td>
</tr>
<tr class="row-odd"><td>12-Lsat</td>
<td><span class="math">\(L_{\mathrm{sat}}\ \mathrm{[m]}\)</span></td>
<td>FEL saturation length (SASE) [m]</td>
</tr>
<tr class="row-even"><td>13-sigmar</td>
<td><span class="math">\(\sigma_r\ \mathrm{[\mu m]}\)</span></td>
<td>Transverse e-beam radius size (rms) [micro m]</td>
</tr>
<tr class="row-odd"><td>14-sigmat</td>
<td><span class="math">\(\sigma_t\ \mathrm{[fs]}\)</span></td>
<td>Temporal bunch length (rms) [fs]</td>
</tr>
<tr class="row-even"><td>15-bandWidth</td>
<td><span class="math">\(\Delta\lambda/\lambda [\%]\)</span></td>
<td>FEL bandwidth [%]</td>
</tr>
<tr class="row-odd"><td>16-PhotonEnergy</td>
<td><span class="math">\(E_p\ \mathrm{[eV]}\)</span></td>
<td>FEL photon energy [eV]</td>
</tr>
<tr class="row-even"><td>17-PulseEnergy</td>
<td><span class="math">\(W\ \mathrm{[\mu J]}\)</span></td>
<td>FEL pulse energy [micro J]</td>
</tr>
<tr class="row-odd"><td>18-PhotonPerPulse</td>
<td><span class="math">\(\mathrm{Photon\ \#/pulse}\)</span></td>
<td>FEL photon number per pulse</td>
</tr>
</tbody>
</table>
<a class="reference internal image-reference" href="../../_images/felformula_04.png"><img alt="../../_images/felformula_04.png" src="../../_images/felformula_04.png" style="width: 500px;" /></a>
<p>The figure will be automatically updated when selected valid parameters.</p>
<a class="reference internal image-reference" href="../../_images/felformula_05.png"><img alt="../../_images/felformula_05.png" src="../../_images/felformula_05.png" style="width: 500px;" /></a>
<p>The data could also be saved by <code class="docutils literal"><span class="pre">SHIFT+CTRL+S</span></code>, or <code class="docutils literal"><span class="pre">CTRL+S</span></code> to save the figure. Select the data columns
that to be saved, the grey ones are invalid, example file see <a class="reference download internal" href="../../_downloads/scan.txt" download=""><code class="xref download docutils literal"><span class="pre">here</span></code></a>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="demo5.html" class="btn btn-neutral float-right" title="Example 5" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="demo3.html" class="btn btn-neutral" title="Example 3" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Tong Zhang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.5.13',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>