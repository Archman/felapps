<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>felapps.utils.datascanframe &mdash; felapps 1.5.13 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.5.13',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="felapps 1.5.13 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">felapps 1.5.13 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for felapps.utils.datascanframe</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Subclass of DataScanFrame, which is generated by wxFormBuilder.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">datascanframe_ui</span> <span class="k">as</span> <span class="nn">dsfui</span>

<span class="kn">import</span> <span class="nn">epics</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.uiutils</span> <span class="k">import</span> <span class="n">EditListFrame</span><span class="p">,</span> <span class="n">EditFrame</span>
<span class="kn">from</span> <span class="nn">.funutils</span> <span class="k">import</span> <span class="n">ScanDataFactor</span><span class="p">,</span> <span class="n">set_staticbmp_color</span><span class="p">,</span> <span class="n">pick_color</span>
<span class="kn">from</span> <span class="nn">.funclistframe</span> <span class="k">import</span> <span class="n">FuncListFrame</span>


<span class="c1"># Implementing DataScanFrame</span>
<div class="viewcode-block" id="DataScanFrame"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame">[docs]</a><span class="k">class</span> <span class="nc">DataScanFrame</span><span class="p">(</span><span class="n">dsfui</span><span class="o">.</span><span class="n">DataScanFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="n">dsfui</span><span class="o">.</span><span class="n">DataScanFrame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_post_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_set_scan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_timers</span><span class="p">()</span>

    <span class="c1"># user-defined event:</span>
    <span class="k">def</span> <span class="nf">_post_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># scan range objs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_range_objs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_from_st</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_from_tc</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">var1_to_st</span><span class="p">,</span>   <span class="bp">self</span><span class="o">.</span><span class="n">var1_to_tc</span><span class="p">]</span>
        <span class="c1"># pv list objs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pv_list_objs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">daq_pv_list_st</span><span class="p">,</span> 
                             <span class="bp">self</span><span class="o">.</span><span class="n">daq_pv_list_tc</span><span class="p">,</span> 
                             <span class="bp">self</span><span class="o">.</span><span class="n">daq_pv_list_btn</span><span class="p">]</span>

        <span class="c1"># advance mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adv_mode_btn</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adv_mode_ckb</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># daq mode</span>
        <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv_list_objs</span><span class="p">]</span>

        <span class="c1"># post-operation onto data from var-II PV</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;none&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_none</span><span class="p">,</span>
                <span class="s1">&#39;sum&#39;</span>  <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_sum</span><span class="p">,</span>
                <span class="s1">&#39;max&#39;</span>  <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_max</span><span class="p">,</span>
                <span class="s1">&#39;min&#39;</span>  <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_min</span><span class="p">,</span>
                <span class="s1">&#39;user-defined&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_other</span><span class="p">,</span>
                <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_user_func</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># user defined functions</span>

        <span class="c1"># set up scan_flag, &#39;xyscan&#39; or &#39;daq&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_flag</span> <span class="o">=</span> <span class="p">{</span><span class="kc">True</span><span class="p">:</span><span class="s1">&#39;xyscan&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">:</span><span class="s1">&#39;daq&#39;</span><span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">ds_flag_rb</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()]</span>

        <span class="c1"># mode_tc, also will be writtne into scan logs </span>
        <span class="c1"># font facename: monospace</span>
        <span class="n">mfont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">GetFont</span><span class="p">()</span>
        <span class="n">mfont</span><span class="o">.</span><span class="n">SetFaceName</span><span class="p">(</span><span class="s1">&#39;Monospace&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetFont</span><span class="p">(</span><span class="n">mfont</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BLACK</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;Parameters scan mode is activated.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># default var2_op_func:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>

        <span class="c1"># default path for user-defined functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func_path</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>

        <span class="c1"># fit control</span>
        <span class="c1"># models</span>
        <span class="n">fit_model_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_model_cb</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_model_cb</span><span class="o">.</span><span class="n">AppendItems</span><span class="p">(</span><span class="n">fit_model_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_model_cb</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        
        <span class="c1"># scan figure style control</span>
        <span class="c1"># line choice</span>
        <span class="n">lineidlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Average Curve&#39;</span><span class="p">,</span> <span class="s1">&#39;Errorbars&#39;</span><span class="p">,</span> <span class="s1">&#39;Fitting Curve&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineid_cb</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineid_cb</span><span class="o">.</span><span class="n">AppendItems</span><span class="p">(</span><span class="n">lineidlist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineid_cb</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;Average Curve&#39;</span><span class="p">)</span>

        <span class="c1"># line style</span>
        <span class="n">lslist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="s1">&#39;dashdot&#39;</span><span class="p">,</span> <span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_cb</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_cb</span><span class="o">.</span><span class="n">AppendItems</span><span class="p">(</span><span class="n">lslist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ls_cb</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>

        <span class="c1"># marker style</span>
        <span class="n">mk_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;none&#39;</span>     <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;none&#39;</span><span class="p">,</span>                              <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span> <span class="p">},</span>
                    <span class="s1">&#39;point&#39;</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{BLACK CIRCLE}</span><span class="s1">&#39;</span><span class="p">,</span>                  <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;.&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;circle&#39;</span>   <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE CIRCLE}</span><span class="s1">&#39;</span><span class="p">,</span>                  <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;o&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;square&#39;</span>   <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE LARGE SQUARE}</span><span class="s1">&#39;</span><span class="p">,</span>            <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;pentagon&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE PENTAGON}</span><span class="s1">&#39;</span><span class="p">,</span>                <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;hexagon1&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE HEXAGON}</span><span class="s1">&#39;</span><span class="p">,</span>                 <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;h&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;diamond&#39;</span>  <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE DIAMOND}</span><span class="s1">&#39;</span><span class="p">,</span>                 <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;tdiamond&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{LOZENGE}</span><span class="s1">&#39;</span><span class="p">,</span>                       <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;star&#39;</span>     <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{STAR OPERATOR}</span><span class="s1">&#39;</span><span class="p">,</span>                 <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;*&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;cross&#39;</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{VECTOR OR CROSS PRODUCT}</span><span class="s1">&#39;</span><span class="p">,</span>       <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;plus&#39;</span>     <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{PLUS SIGN}</span><span class="s1">&#39;</span><span class="p">,</span>                     <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;hline&#39;</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{MINUS SIGN}</span><span class="s1">&#39;</span><span class="p">,</span>                    <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;_&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;vline&#39;</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{DIVIDES}</span><span class="s1">&#39;</span><span class="p">,</span>                       <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;|&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;tri_down&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE DOWN-POINTING TRIANGLE}</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;tri_up&#39;</span>   <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE UP-POINTING TRIANGLE}</span><span class="s1">&#39;</span><span class="p">,</span>    <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;^&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;tri_right&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE RIGHT-POINTING TRIANGLE}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;tri_left&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="s1">u&#39;</span><span class="se">\N{WHITE LEFT-POINTING TRIANGLE}</span><span class="s1">&#39;</span><span class="p">,</span>  <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">},</span>
                <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkstyle_cb</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="n">mk_code</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span>   <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">mk_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mk_symbol</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;symbol&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">mk_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkstyle_cb</span><span class="o">.</span><span class="n">AppendItems</span><span class="p">(</span><span class="n">mk_code</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkstyle_cb</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="c1"># lc, mec, mfc</span>
        <span class="c1"># average line: lc: wx.GREEN, mec: wx.BLUE, mfc: wx.BLUE</span>
        <span class="c1"># errorbar    : lc: wx.RED,   mec: wx.RED,  mfc: wx.RED</span>
        <span class="n">set_staticbmp_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lc_btn</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
        <span class="n">set_staticbmp_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mfc_btn</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BLUE</span><span class="p">)</span>
        <span class="n">set_staticbmp_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mec_btn</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">BLUE</span><span class="p">)</span>

        <span class="c1"># fit_report_tc</span>
        <span class="n">tfont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_report_tc</span><span class="o">.</span><span class="n">GetFont</span><span class="p">()</span>
        <span class="n">tfont</span><span class="o">.</span><span class="n">SetFaceName</span><span class="p">(</span><span class="s1">&#39;monospace&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_report_tc</span><span class="o">.</span><span class="n">SetFont</span><span class="p">(</span><span class="n">tfont</span><span class="p">)</span>

        <span class="c1"># initial additional fitting parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_post_set_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; set scan configuration parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaniternum_val</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iternum_sc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>             <span class="c1"># total number of scan points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waitmsec_val</span>     <span class="o">=</span> <span class="mf">1000.0</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">waittime_sc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>   <span class="c1"># time wait after every scan data setup, in millisecond</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span>      <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shotperiter_sc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>  <span class="c1"># shots number to be recorded for each scan iteration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scandaqfreq_val</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">daqrate_sc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>      <span class="c1"># scan rep-rate [Hz]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scandaqdelt_msec</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scandaqfreq_val</span><span class="p">)</span>   <span class="c1"># scan daq timer interval [ms]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scandelt_msec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waitmsec_val</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scandaqdelt_msec</span>

        <span class="c1"># debug only</span>
        <span class="c1">#print(&quot;iter:{iter}, shot#:{shot}, wait_t:{wt}, daq:{daq}&quot;.format(</span>
        <span class="c1">#    iter=self.scaniternum_val, shot=self.shotnum_val,</span>
        <span class="c1">#    wt=self.waitmsec_val, daq=self.scandaqfreq_val))</span>
    
    <span class="k">def</span> <span class="nf">_init_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># tick timer</span>
        <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S %Z&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timenow_st</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_timer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TIMER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tick_timerOnTimer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tick_timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tick_timer</span><span class="o">.</span><span class="n">Start</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># scan ctrl timer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TIMER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timerOnTimer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timer</span><span class="p">)</span>

        <span class="c1"># scan dq timer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TIMER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timerOnTimer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timer</span><span class="p">)</span>

    <span class="c1"># menu items events leave to be implemented</span>
<div class="viewcode-block" id="DataScanFrame.save_mitemOnMenuSelection"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.save_mitemOnMenuSelection">[docs]</a>    <span class="k">def</span> <span class="nf">save_mitemOnMenuSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DataScanFrame.exit_mitemOnMenuSelection"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.exit_mitemOnMenuSelection">[docs]</a>    <span class="k">def</span> <span class="nf">exit_mitemOnMenuSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DataScanFrame.about_mitemOnMenuSelection"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.about_mitemOnMenuSelection">[docs]</a>    <span class="k">def</span> <span class="nf">about_mitemOnMenuSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DataScanFrame.tick_timerOnTimer"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.tick_timerOnTimer">[docs]</a>    <span class="k">def</span> <span class="nf">tick_timerOnTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S %Z&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timenow_st</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()))</span></div>

<div class="viewcode-block" id="DataScanFrame.iternum_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.iternum_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">iternum_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaniternum_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iternum_sc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_set_scan</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.shotperiter_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.shotperiter_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">shotperiter_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_set_scan</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.waittime_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.waittime_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">waittime_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waitmsec_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_set_scan</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.daqrate_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.daqrate_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">daqrate_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scandaqfreq_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_set_scan</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.var1_pv_flag_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.var1_pv_flag_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">var1_pv_flag_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_pv_flag_ckb</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var1_pv_read_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_pv_set_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var1_pv_read_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.ds_flag_rbOnRadioButton"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.ds_flag_rbOnRadioButton">[docs]</a>    <span class="k">def</span> <span class="nf">ds_flag_rbOnRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds_flag_rb</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_range_objs</span><span class="p">]</span>
            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv_list_objs</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BLACK</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;Parameters scan mode is activated.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_flag</span> <span class="o">=</span> <span class="s1">&#39;xyscan&#39;</span></div>

<div class="viewcode-block" id="DataScanFrame.daq_flag_rbOnRadioButton"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.daq_flag_rbOnRadioButton">[docs]</a>    <span class="k">def</span> <span class="nf">daq_flag_rbOnRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_flag_rb</span><span class="o">.</span><span class="n">GetValue</span><span class="p">():</span>
            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_range_objs</span><span class="p">]</span>
            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv_list_objs</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BLACK</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;Data correlation analysis mode is activated.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_flag</span> <span class="o">=</span> <span class="s1">&#39;daq&#39;</span></div>

<div class="viewcode-block" id="DataScanFrame.var2_op_comboxOnCombobox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.var2_op_comboxOnCombobox">[docs]</a>    <span class="k">def</span> <span class="nf">var2_op_comboxOnCombobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_combox</span>
        <span class="n">op_func</span><span class="p">,</span> <span class="n">hint_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_dict</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">()]()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_st</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="n">hint_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_func</span> <span class="o">=</span> <span class="n">op_func</span></div>

<div class="viewcode-block" id="DataScanFrame.fit_model_cbOnCombobox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_model_cbOnCombobox">[docs]</a>    <span class="k">def</span> <span class="nf">fit_model_cbOnCombobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_curve</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.fit_config_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_config_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">fit_config_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_config_ckb</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_config_btn</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_config_btn</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.fit_config_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_config_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">fit_config_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">add_param_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_param_dict</span>
        <span class="n">init_string_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;=&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()])</span> 
                            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">add_param_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">MyEditConfigFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_string_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Config List&#39;</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s1">&#39;Additional Config&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetScreenPosition</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span></div>

<div class="viewcode-block" id="DataScanFrame.fit_refresh_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_refresh_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">fit_refresh_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; refresh fit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_model_cb</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_curve</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.fit_to_fig_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_to_fig_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">fit_to_fig_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; stick fit result onto scan figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stick_text</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="DataScanFrame.stick_pos_tcOnTextEnter"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.stick_pos_tcOnTextEnter">[docs]</a>    <span class="k">def</span> <span class="nf">stick_pos_tcOnTextEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="p">,</span> <span class="s1">&#39;func_text&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stick_text</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stick_pos_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
                <span class="n">kws</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)]}</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">kws</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">update_text</span><span class="p">(</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span> </div>

<div class="viewcode-block" id="DataScanFrame.adv_mode_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.adv_mode_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">adv_mode_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adv_mode_ckb</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adv_mode_btn</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adv_mode_btn</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.var1_from_tcOnTextEnter"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.var1_from_tcOnTextEnter">[docs]</a>    <span class="k">def</span> <span class="nf">var1_from_tcOnTextEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">dial</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">message</span><span class="o">=</span><span class="s2">u&quot;Please input a number.&quot;</span><span class="p">,</span>
                                    <span class="n">caption</span><span class="o">=</span><span class="s2">u&quot;Input Warning&quot;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_WARNING</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTRE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dial</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">dial</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.var1_to_tcOnTextEnter"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.var1_to_tcOnTextEnter">[docs]</a>    <span class="k">def</span> <span class="nf">var1_to_tcOnTextEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">dial</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">message</span><span class="o">=</span><span class="s2">u&quot;Please input a number.&quot;</span><span class="p">,</span>
                                    <span class="n">caption</span><span class="o">=</span><span class="s2">u&quot;Input Warning&quot;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_WARNING</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTRE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dial</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">dial</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.var1_pv_tcOnTextEnter"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.var1_pv_tcOnTextEnter">[docs]</a>    <span class="k">def</span> <span class="nf">var1_pv_tcOnTextEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">pv_string</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pv_check</span><span class="p">(</span><span class="n">pv_string</span><span class="p">):</span>
            <span class="n">dial</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">message</span><span class="o">=</span><span class="s2">u&quot;Input PV: &quot;</span> <span class="o">+</span> <span class="n">pv_string</span> <span class="o">+</span> <span class="s2">&quot; could not be reached.&quot;</span><span class="p">,</span>
                                    <span class="n">caption</span><span class="o">=</span><span class="s2">u&quot;PV Warning&quot;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_WARNING</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTRE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dial</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">dial</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.var2_pv_tcOnTextEnter"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.var2_pv_tcOnTextEnter">[docs]</a>    <span class="k">def</span> <span class="nf">var2_pv_tcOnTextEnter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">pv_string</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pv_check</span><span class="p">(</span><span class="n">pv_string</span><span class="p">):</span>
            <span class="n">dial</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">message</span><span class="o">=</span><span class="s2">u&quot;Input PV: &quot;</span> <span class="o">+</span> <span class="n">pv_string</span> <span class="o">+</span> <span class="s2">&quot; could not be reached.&quot;</span><span class="p">,</span>
                                    <span class="n">caption</span><span class="o">=</span><span class="s2">u&quot;PV Warning&quot;</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_WARNING</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTRE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dial</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">dial</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="DataScanFrame.start_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.start_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">start_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># set log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BLUE</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s2">&quot;Initiate scan routine...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># set scan params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scan_params</span><span class="p">()</span>

        <span class="c1"># debug only</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="c1"># start timestamp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="c1"># start scan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accum_scan_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timer</span><span class="o">.</span><span class="n">Start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scandelt_msec</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DataScanFrame.stop_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.stop_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">stop_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
        <span class="c1"># set log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">GREEN</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s2">&quot;Stop scan routine...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.retake_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.retake_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">retake_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1">#print self.add_param_dict</span>
        <span class="n">pick_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">get_pick_pt</span><span class="p">()</span>
        <span class="c1">#a = self.scan_output_all</span>
        <span class="c1">#b = self.var1_range_array</span>
        <span class="c1">#for k,v in pick_pt.iteritems():</span>
        <span class="c1">#    print(k)</span>
        <span class="c1">#    print(b[k])</span>
        <span class="c1">#    print(a[self.shotnum_val*k:self.shotnum_val*(k+1)])</span>
        <span class="c1">#    print(a[self.shotnum_val*k:self.shotnum_val*(k+1)][:,0].mean())</span>
        <span class="c1">#    print(a[self.shotnum_val*k:self.shotnum_val*(k+1)][:,1].mean())</span>

        <span class="n">retake_delt_msec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scandelt_msec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retake_indice</span> <span class="o">=</span> <span class="n">pick_pt</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx_retake</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx_retake_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retake_indice</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_retake_flag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timer</span><span class="o">.</span><span class="n">Start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scandelt_msec</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="DataScanFrame.set_retake_flag"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.set_retake_flag">[docs]</a>    <span class="k">def</span> <span class="nf">set_retake_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; set retake process flag</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retake_flag</span> <span class="o">=</span> <span class="kc">True</span></div>
            
<div class="viewcode-block" id="DataScanFrame.unset_retake_flag"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.unset_retake_flag">[docs]</a>    <span class="k">def</span> <span class="nf">unset_retake_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retake_flag</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="DataScanFrame.daq_pv_list_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.daq_pv_list_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">daq_pv_list_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">init_string_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_pv_list_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">MyEditListFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_string_list</span><span class="p">,</span> <span class="s1">&#39;PV List&#39;</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s1">&#39;Make PV List&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetScreenPosition</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span></div>

<div class="viewcode-block" id="DataScanFrame.scan_ctrl_timerOnTimer"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.scan_ctrl_timerOnTimer">[docs]</a>    <span class="k">def</span> <span class="nf">scan_ctrl_timerOnTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; scan procedure control timer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">retake_flag</span><span class="p">:</span>  <span class="c1"># retake is not enabled</span>
                <span class="c1">#print &quot;active normal process&quot;, self.var1_idx, self.var1_range_num</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_num</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var1_set_PV</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_range_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_idx</span><span class="p">])</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">MilliSleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">waitmsec_val</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_scan_daq_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scandaqdelt_msec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">retake_flag</span><span class="p">:</span>  <span class="c1"># retake is enabled</span>
                <span class="c1">#print &quot;active retake process&quot;, self.var1_idx_retake, self.var1_idx_retake_length</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx_retake</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx_retake_length</span>
                <span class="n">retake_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retake_indice</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_idx_retake</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var1_set_PV</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_range_array</span><span class="p">[</span><span class="n">retake_idx</span><span class="p">])</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">MilliSleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">waitmsec_val</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_scan_daq_timer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scandaqdelt_msec</span><span class="p">,</span> <span class="n">retake_idx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx_retake</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_ctrl_timer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">daq_cnt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unset_retake_flag</span><span class="p">()</span>
            <span class="c1"># set log</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">BLUE</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s2">&quot;Stop scan routine...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S %Z&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_time</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{dt:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">seconds</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_scandiag</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.scan_daq_timerOnTimer"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.scan_daq_timerOnTimer">[docs]</a>    <span class="k">def</span> <span class="nf">scan_daq_timerOnTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; timer to control every scan iteration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_output_iter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">daq_cnt</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_get_PV</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var2_get_PV</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_cnt</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timer</span><span class="o">.</span><span class="n">Stop</span><span class="p">()</span>
            <span class="c1"># write scan log to mode_tc</span>
            <span class="n">logmsg</span> <span class="o">=</span> <span class="s1">&#39;Iter#: </span><span class="si">{0:&gt;3d}</span><span class="s1"> is DONE, scan value: </span><span class="si">{1:&lt;.3f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">scan_idx_now</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> 
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scan_idx_now</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">SetDefaultStyle</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">RED</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">logmsg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_output_all</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">scan_idx_now</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span><span class="p">:(</span><span class="bp">self</span><span class="o">.</span><span class="n">scan_idx_now</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_output_iter</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_scanfigure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daq_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accum_scan_num</span> <span class="o">+=</span> <span class="mi">1</span></div>

    <span class="c1"># plot style configurations</span>
<div class="viewcode-block" id="DataScanFrame.lineid_cbOnCombobox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.lineid_cbOnCombobox">[docs]</a>    <span class="k">def</span> <span class="nf">lineid_cbOnCombobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineid_cb</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_line_id</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.mks_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.mks_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">mks_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_mks</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.mew_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.mew_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">mew_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_mew</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.lw_scOnSpinCtrl"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.lw_scOnSpinCtrl">[docs]</a>    <span class="k">def</span> <span class="nf">lw_scOnSpinCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="DataScanFrame.lc_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.lc_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">lc_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">pick_color</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">C2S_HTML_SYNTAX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_linecolor</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">set_staticbmp_color</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.mec_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.mec_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">mec_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">pick_color</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">C2S_HTML_SYNTAX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_mec</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">set_staticbmp_color</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.mfc_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.mfc_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">mfc_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">pick_color</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">GetAsString</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">C2S_HTML_SYNTAX</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_mfc</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">set_staticbmp_color</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.mkstyle_cbOnCombobox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.mkstyle_cbOnCombobox">[docs]</a>    <span class="k">def</span> <span class="nf">mkstyle_cbOnCombobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">new_mk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mk_symbol</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_marker</span><span class="p">(</span><span class="n">new_mk</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.ls_cbOnCombobox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.ls_cbOnCombobox">[docs]</a>    <span class="k">def</span> <span class="nf">ls_cbOnCombobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">new_ls</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetStringSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="n">new_ls</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.grid_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.grid_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">grid_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_grid</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.legend_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.legend_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">legend_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
            <span class="n">show_val</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_legend</span><span class="p">(</span><span class="n">avg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="n">show_val</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
    
<div class="viewcode-block" id="DataScanFrame.auto_xlabel_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.auto_xlabel_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">auto_xlabel_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
            <span class="n">user_xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_get_PV</span><span class="o">.</span><span class="n">pvname</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                        <span class="o">+</span> <span class="s1">&#39;(scan dependent:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2_get_PV</span><span class="o">.</span><span class="n">pvname</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_xlabel_ckb</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
                <span class="n">user_xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_xlabel_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">user_xlabel</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="DataScanFrame.user_xlabel_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.user_xlabel_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">user_xlabel_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_xlabel_tc</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_xlabel_tc</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="DataScanFrame.auto_title_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.auto_title_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">auto_title_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
            <span class="n">user_title</span> <span class="o">=</span> <span class="s1">&#39;Completed at: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_timestamp</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                         <span class="o">+</span> <span class="s1">&#39;SCAN TIME: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_time</span> <span class="o">+</span> <span class="s1">&#39; sec&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_USER_TITLE</span> <span class="o">=</span> <span class="n">user_title</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_title_ckb</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
                <span class="n">user_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_title_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$TITLE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_USER_TITLE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="n">user_title</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="DataScanFrame.user_title_ckbOnCheckBox"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.user_title_ckbOnCheckBox">[docs]</a>    <span class="k">def</span> <span class="nf">user_title_ckbOnCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span><span class="o">.</span><span class="n">IsChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_title_tc</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_title_tc</span><span class="o">.</span><span class="n">Disable</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.clr_retake_btnOnButtonClick"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.clr_retake_btnOnButtonClick">[docs]</a>    <span class="k">def</span> <span class="nf">clr_retake_btnOnButtonClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">clear_pick_pt</span><span class="p">()</span></div>

    <span class="c1"># user-defined methods</span>
<div class="viewcode-block" id="DataScanFrame.fit_curve"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_curve">[docs]</a>    <span class="k">def</span> <span class="nf">fit_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">model</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x_fit_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_param_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">)</span>
            <span class="n">x_fit_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_param_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmax&#39;</span><span class="p">)</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x_fit_min</span><span class="p">)</span> <span class="k">if</span> <span class="n">x_fit_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x_fit_max</span><span class="p">)</span> <span class="k">if</span> <span class="n">x_fit_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">hide_fit_line</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_fit_model</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">:</span>
                <span class="n">n_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_param_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">n_order</span> <span class="k">if</span> <span class="n">n_order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_fit_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
                                                 <span class="n">xmin</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_fit_line</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">get_fit_model</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
        
<div class="viewcode-block" id="DataScanFrame.fit_report"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.fit_report">[docs]</a>    <span class="k">def</span> <span class="nf">fit_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        fill fit_report_tc with curve fitting report</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_report_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">30</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_report_tc</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span></div>

    <span class="k">def</span> <span class="nf">_pv_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; check if pv string of val is alive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">pv</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">get_pv</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">connect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pv</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">def</span> <span class="nf">_op_none</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hint_text</span> <span class="o">=</span> <span class="s2">u&quot;Raw data.&quot;</span>
        <span class="n">op_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">op_func</span><span class="p">,</span> <span class="n">hint_text</span>

    <span class="k">def</span> <span class="nf">_op_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hint_text</span> <span class="o">=</span> <span class="s2">u&quot;Integrate intensity.&quot;</span>
        <span class="n">op_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">op_func</span><span class="p">,</span> <span class="n">hint_text</span>

    <span class="k">def</span> <span class="nf">_op_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hint_text</span> <span class="o">=</span> <span class="s2">u&quot;Get max number.&quot;</span>
        <span class="n">op_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">op_func</span><span class="p">,</span> <span class="n">hint_text</span>

    <span class="k">def</span> <span class="nf">_op_min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hint_text</span> <span class="o">=</span> <span class="s2">u&quot;Get min number.&quot;</span>
        <span class="n">op_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">op_func</span><span class="p">,</span> <span class="n">hint_text</span>

    <span class="k">def</span> <span class="nf">_op_other</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hint_text</span> <span class="o">=</span> <span class="s2">u&quot;Use user-defined function.&quot;</span>
        <span class="n">op_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2_op_combox</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">FuncListFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func_path</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s1">&#39;Input User-defined Function&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetScreenPosition</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">op_func</span><span class="p">,</span> <span class="n">hint_text</span> 

<div class="viewcode-block" id="DataScanFrame.set_scan_params"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.set_scan_params">[docs]</a>    <span class="k">def</span> <span class="nf">set_scan_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;set up scan parameters, var1(x) and var2(y)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unset_retake_flag</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_flag</span> <span class="o">==</span> <span class="s1">&#39;xyscan&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_xyvars</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_flag</span> <span class="o">==</span> <span class="s1">&#39;daq&#39;</span><span class="p">:</span>
            <span class="c1"># do daq</span>
            <span class="k">pass</span></div>
    
    <span class="k">def</span> <span class="nf">_set_xyvars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># scan variable, var1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_set_PV</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">PV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_pv_set_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_get_PV</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">PV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_pv_read_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_from_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_to_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaniternum_val</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var1_range_min</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_max</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_num</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var1_idx</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># initial index of var1_range_array</span>

        <span class="c1"># scan dependent variable, var2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var2_get_PV</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">PV</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var2_pv_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        
        <span class="c1"># construct n x 2 array to put scan output, where n is the total record number</span>
        <span class="c1"># n = iteration_num x shot_num_per_iteration</span>
        <span class="c1"># scan_output_all : numpy array for all records,</span>
        <span class="c1"># scan_output_iter: numpy array for one iteration</span>

        <span class="c1">#self.scan_output_all = np.zeros((self.var1_range_num * self.shotnum_val, 2)) </span>
        <span class="n">total_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_num</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_output_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]]</span><span class="o">*</span><span class="n">total_num</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_output_iter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<div class="viewcode-block" id="DataScanFrame.start_scan_daq_timer"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.start_scan_daq_timer">[docs]</a>    <span class="k">def</span> <span class="nf">start_scan_daq_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">scanidx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_idx_now</span> <span class="o">=</span> <span class="n">scanidx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daq_cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_daq_timer</span><span class="o">.</span><span class="n">Start</span><span class="p">(</span><span class="n">ms</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataScanFrame.update_scanfigure"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.update_scanfigure">[docs]</a>    <span class="k">def</span> <span class="nf">update_scanfigure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; update figure plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scandata_ins</span> <span class="o">=</span> <span class="n">ScanDataFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scan_output_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var1_range_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shotnum_val</span><span class="p">)</span>
        <span class="n">xerr_ins</span> <span class="o">=</span> <span class="n">scandata_ins</span><span class="o">.</span><span class="n">getXerrbar</span><span class="p">()</span>
        <span class="n">yerr_ins</span> <span class="o">=</span> <span class="n">scandata_ins</span><span class="o">.</span><span class="n">getYerrbar</span><span class="p">()</span>
        <span class="c1">#idx = scandata_ins.getYavg()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">scandata_ins</span><span class="o">.</span><span class="n">getXavg</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">scandata_ins</span><span class="o">.</span><span class="n">getYavg</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">xerrarr</span> <span class="o">=</span> <span class="n">xerr_ins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">yerrarr</span> <span class="o">=</span> <span class="n">yerr_ins</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">repaint</span><span class="p">()</span></div>

<div class="viewcode-block" id="DataScanFrame.show_scandiag"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.DataScanFrame.show_scandiag">[docs]</a>    <span class="k">def</span> <span class="nf">show_scandiag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; show dialog when scan is done</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dial</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Finish data scan analysis.</span><span class="se">\n</span><span class="s2">Apply proper curve fitting and Save data by CTRL+S.&quot;</span><span class="p">,</span>
                                <span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Scan Done&#39;</span><span class="p">,</span>
                                <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CENTRE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_QUESTION</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dial</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">dial</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_stick_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; write fitting text information onto figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">get_fit_model</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">fit_report</span><span class="p">()</span>
        <span class="n">fx</span><span class="p">,</span> <span class="n">ft</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">get_fitfunc</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ft</span><span class="p">[</span><span class="s1">&#39;func&#39;</span><span class="p">],</span> <span class="n">ft</span><span class="p">[</span><span class="s1">&#39;fcoef&#39;</span><span class="p">]])</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stick_pos_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kws</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)]}</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">kws</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scanfig_panel</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span> </div>


<div class="viewcode-block" id="MyEditListFrame"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.MyEditListFrame">[docs]</a><span class="k">class</span> <span class="nc">MyEditListFrame</span><span class="p">(</span><span class="n">EditListFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">string_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">EditListFrame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">string_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>

<div class="viewcode-block" id="MyEditListFrame.on_ok"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.MyEditListFrame.on_ok">[docs]</a>    <span class="k">def</span> <span class="nf">on_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">str_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elb</span><span class="o">.</span><span class="n">GetStrings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">daq_pv_list_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_list</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="MyEditConfigFrame"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.MyEditConfigFrame">[docs]</a><span class="k">class</span> <span class="nc">MyEditConfigFrame</span><span class="p">(</span><span class="n">EditListFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">string_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">EditListFrame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">string_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>

<div class="viewcode-block" id="MyEditConfigFrame.on_ok"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.MyEditConfigFrame.on_ok">[docs]</a>    <span class="k">def</span> <span class="nf">on_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">str_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elb</span><span class="o">.</span><span class="n">GetStrings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">add_param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">str_list</span><span class="p">]}</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span></div></div>

<div class="viewcode-block" id="MyEditFrame"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.MyEditFrame">[docs]</a><span class="k">class</span> <span class="nc">MyEditFrame</span><span class="p">(</span><span class="n">EditListFrame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">string_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">EditFrame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">string_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        
<div class="viewcode-block" id="MyEditFrame.on_ok"><a class="viewcode-back" href="../../../src/apidocs/felapps.utils.html#felapps.utils.datascanframe.MyEditFrame.on_ok">[docs]</a>    <span class="k">def</span> <span class="nf">on_ok</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_user_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elb</span><span class="o">.</span><span class="n">GetStrings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">felapps 1.5.13 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Tong Zhang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>